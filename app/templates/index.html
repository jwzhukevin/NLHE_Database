{% extends 'base.html' %}

{% block content %}
<!-- ====================== 数据表格容器 ====================== -->
<div class="data-table-container">
    <style>
    .data-table-container {
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 20px;
    }
    </style>

    <!-- ====================== 搜索表单 ====================== -->
    <form method="GET" action="{{ url_for('views.index') }}" class="search-form" id="searchForm" onsubmit="return validateSearch()">
        <style>
        /* 搜索表单容器 */
        .search-form {
          /* ---------- 可调节参数 ---------- */
          --form-max-width: 1000px;        /* 控制表单最大宽度，避免在大屏幕上过宽 */
          --form-padding: 1.0rem;         /* 表单内边距，影响内容与边框的距离 */
          --form-gap: 1.0rem;            /* 表单项之间的垂直间距 */
          --border-width: 2px;           /* 表单整体边框粗细 */
          --border-radius: 10px;         /* 表单整体圆角半径 */

          /* 输入控件参数 */
          --input-height: 2rem;          /* 所有输入框/下拉框的统一高度（注意单位） */
          --input-padding: 0.2rem;       /* 输入框内文字与边框的间距 */
          --input-font-size: clamp(0.6rem, 1.0vw, 2.0rem); /* 响应式字体：最小1rem，随视口增长，最大1.2rem */

          /* 按钮参数 */
          --btn-padding: 0.2rem 0.6rem;  /* 按钮内边距（上下 左右） */
          --btn-font-size: clamp(0.6rem, 1.2vw, 2.0rem);       /* 按钮文字大小 */
          --btn-radius: 5px;             /* 按钮圆角半径 */

          /* ---------- 布局样式 ---------- */
          margin: 2rem auto;             /* 上下2rem，左右居中 */
          max-width: var(--form-max-width); /* 应用最大宽度变量 */
          border: var(--border-width) solid #eee; /* 边框样式（颜色#eee） */
          border-radius: var(--border-radius); /* 应用圆角变量 */
          padding: var(--form-padding);  /* 内边距 */
          display: flex;                 /* 弹性布局 */
          flex-direction: column;        /* 垂直排列子元素 */
          gap: var(--form-gap);          /* 子元素间垂直间距 */
          background-color: white;
          box-shadow: var(--card-shadow);
          padding: 2rem;
          margin-bottom: 2rem;
        }
        </style>

        <!-- 基本搜索 -->
        <div class="basic-search">
            <input type="text" 
                   name="q" 
                   id="searchInput"
                   placeholder="Search materials..." 
                   value="{{ search_params.q }}"
                   aria-label="Search">
            <button type="submit" class="btn">Search</button>
            <button type="button" class="btn" id="elementsToggleBtn">Elements</button>
            <button type="button" class="btn" onclick="toggleAdvanced()">Advanced</button>
        </div>
        <style>
        /* 基础搜索区域 */
        .basic-search {
          display: flex;                 /* 弹性布局使输入框和按钮横向排列 */
          gap: 0.5rem;                   /* 减小子元素间距 */
          position: relative;            /* 为子元素定位提供参考系 */

          /* 主搜索输入框特定样式 */
          & input[type="text"] {
            flex: 1;                     /* 占据剩余所有空间 */
            height: 2.5rem;              /* 增加高度 */
            padding: 0.5rem 1rem;        /* 适当的内边距 */
            font-size: 1rem;             /* 字体大小 */
            border: 1px solid #D9E2F0;   /* 边框 */
            border-radius: 4px;          /* 减小圆角 */
            transition: border-color 0.1s; /* 边框颜色过渡动画 */
          }

          /* 聚焦状态增强 */
          & input[type="text"]:focus {
            border-color: var(--primary-color); /* 加深边框颜色 */
            outline: none;               /* 移除浏览器默认轮廓线 */
            box-shadow: 0 0 4px rgba(0, 71, 171, 0.2); /* 添加发光效果 */
          }
        }

        /* 搜索按钮样式 */
        .basic-search .btn {
          height: 2.5rem;               /* 与输入框相同高度 */
          padding: 0 1.5rem;            /* 适当的内边距 */
          border-radius: 4px;           /* 减小圆角 */
          font-size: 1rem;              /* 字体大小 */
          font-weight: 500;             /* 字体粗细 */
          transition: all 0.2s;         /* 过渡效果 */
        }
        </style>

        <!-- 元素周期表组件 -->
        <div class="periodic-table-wrapper" id="periodicTableWrapper" style="display: none;">
            <div class="elements-header">
                <span>Select Elements</span>
                <span id="selectedElementsCount">0 selected</span>
            </div>
            <div class="periodic-table-container">
                <div class="periodic-table" id="periodicTable">
                    <!-- 第一行 -->
                    <div class="element nonmetal" data-symbol="H">
                        H
                        <div class="tooltip">
                            <strong>Hydrogen (H)</strong><br>
                            Atomic No: 1<br>
                            Mass: 1.008<br>
                            Electron: 1s¹
                        </div>
                    </div>
                    <div class="element-spacer" style="grid-column: span 16;"></div>
                    <div class="element noble" data-symbol="He">
                        He
                        <div class="tooltip">
                            <strong>Helium (He)</strong><br>
                            Atomic No: 2<br>
                            Mass: 4.0026<br>
                            Electron: 1s²
                        </div>
                </div>
                
                    <!-- 第二行 -->
                    <div class="element alkali" data-symbol="Li">
                        Li
                        <div class="tooltip">
                            <strong>Lithium (Li)</strong><br>
                            Atomic No: 3<br>
                            Mass: 6.94<br>
                            Electron: [He] 2s¹
                        </div>
                    </div>
                    <div class="element alkaline" data-symbol="Be">
                        Be
                        <div class="tooltip">
                            <strong>Beryllium (Be)</strong><br>
                            Atomic No: 4<br>
                            Mass: 9.0122<br>
                            Electron: [He] 2s²
                        </div>
                    </div>
                    <div class="element-spacer" style="grid-column: span 10;"></div>
                    <div class="element metalloid" data-symbol="B">
                        B
                        <div class="tooltip">
                            <strong>Boron (B)</strong><br>
                            Atomic No: 5<br>
                            Mass: 10.81<br>
                            Electron: [He] 2s² 2p¹
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="C">
                        C
                        <div class="tooltip">
                            <strong>Carbon (C)</strong><br>
                            Atomic No: 6<br>
                            Mass: 12.011<br>
                            Electron: [He] 2s² 2p²
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="N">
                        N
                        <div class="tooltip">
                            <strong>Nitrogen (N)</strong><br>
                            Atomic No: 7<br>
                            Mass: 14.007<br>
                            Electron: [He] 2s² 2p³
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="O">
                        O
                        <div class="tooltip">
                            <strong>Oxygen (O)</strong><br>
                            Atomic No: 8<br>
                            Mass: 15.999<br>
                            Electron: [He] 2s² 2p⁴
                        </div>
                    </div>
                    <div class="element halogen" data-symbol="F">
                        F
                        <div class="tooltip">
                            <strong>Fluorine (F)</strong><br>
                            Atomic No: 9<br>
                            Mass: 18.998<br>
                            Electron: [He] 2s² 2p⁵
                        </div>
                    </div>
                    <div class="element noble" data-symbol="Ne">
                        Ne
                        <div class="tooltip">
                            <strong>Neon (Ne)</strong><br>
                            Atomic No: 10<br>
                            Mass: 20.180<br>
                            Electron: [He] 2s² 2p⁶
                </div>
            </div>
            
                    <!-- 第三行 -->
                    <div class="element alkali" data-symbol="Na">
                        Na
                        <div class="tooltip">
                            <strong>Sodium (Na)</strong><br>
                            Atomic No: 11<br>
                            Mass: 22.990<br>
                            Electron: [Ne] 3s¹
                        </div>
                    </div>
                    <div class="element alkaline" data-symbol="Mg">
                        Mg
                        <div class="tooltip">
                            <strong>Magnesium (Mg)</strong><br>
                            Atomic No: 12<br>
                            Mass: 24.305<br>
                            Electron: [Ne] 3s²
                        </div>
                    </div>
                    <div class="element-spacer" style="grid-column: span 10;"></div>
                    <div class="element post-transition" data-symbol="Al">
                        Al
                        <div class="tooltip">
                            <strong>Aluminum (Al)</strong><br>
                            Atomic No: 13<br>
                            Mass: 26.982<br>
                            Electron: [Ne] 3s² 3p¹
                        </div>
                    </div>
                    <div class="element metalloid" data-symbol="Si">
                        Si
                        <div class="tooltip">
                            <strong>Silicon (Si)</strong><br>
                            Atomic No: 14<br>
                            Mass: 28.085<br>
                            Electron: [Ne] 3s² 3p²
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="P">
                        P
                        <div class="tooltip">
                            <strong>Phosphorus (P)</strong><br>
                            Atomic No: 15<br>
                            Mass: 30.974<br>
                            Electron: [Ne] 3s² 3p³
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="S">
                        S
                        <div class="tooltip">
                            <strong>Sulfur (S)</strong><br>
                            Atomic No: 16<br>
                            Mass: 32.06<br>
                            Electron: [Ne] 3s² 3p⁴
                        </div>
                    </div>
                    <div class="element halogen" data-symbol="Cl">
                        Cl
                        <div class="tooltip">
                            <strong>Chlorine (Cl)</strong><br>
                            Atomic No: 17<br>
                            Mass: 35.45<br>
                            Electron: [Ne] 3s² 3p⁵
                        </div>
                    </div>
                    <div class="element noble" data-symbol="Ar">
                        Ar
                        <div class="tooltip">
                            <strong>Argon (Ar)</strong><br>
                            Atomic No: 18<br>
                            Mass: 39.948<br>
                            Electron: [Ne] 3s² 3p⁶
                    </div>
                </div>
            
                    <!-- 第四行 -->
                    <div class="element alkali" data-symbol="K">
                        K
                        <div class="tooltip">
                            <strong>Potassium (K)</strong><br>
                            Atomic No: 19<br>
                            Mass: 39.098<br>
                            Electron: [Ar] 4s¹
                    </div>
                    </div>
                    <div class="element alkaline" data-symbol="Ca">
                        Ca
                        <div class="tooltip">
                            <strong>Calcium (Ca)</strong><br>
                            Atomic No: 20<br>
                            Mass: 40.078<br>
                            Electron: [Ar] 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Sc">
                        Sc
                        <div class="tooltip">
                            <strong>Scandium (Sc)</strong><br>
                            Atomic No: 21<br>
                            Mass: 44.956<br>
                            Electron: [Ar] 3d¹ 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ti">
                        Ti
                        <div class="tooltip">
                            <strong>Titanium (Ti)</strong><br>
                            Atomic No: 22<br>
                            Mass: 47.867<br>
                            Electron: [Ar] 3d² 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="V">
                        V
                        <div class="tooltip">
                            <strong>Vanadium (V)</strong><br>
                            Atomic No: 23<br>
                            Mass: 50.942<br>
                            Electron: [Ar] 3d³ 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Cr">
                        Cr
                        <div class="tooltip">
                            <strong>Chromium (Cr)</strong><br>
                            Atomic No: 24<br>
                            Mass: 51.996<br>
                            Electron: [Ar] 3d⁵ 4s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Mn">
                        Mn
                        <div class="tooltip">
                            <strong>Manganese (Mn)</strong><br>
                            Atomic No: 25<br>
                            Mass: 54.938<br>
                            Electron: [Ar] 3d⁵ 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Fe">
                        Fe
                        <div class="tooltip">
                            <strong>Iron (Fe)</strong><br>
                            Atomic No: 26<br>
                            Mass: 55.845<br>
                            Electron: [Ar] 3d⁶ 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Co">
                        Co
                        <div class="tooltip">
                            <strong>Cobalt (Co)</strong><br>
                            Atomic No: 27<br>
                            Mass: 58.933<br>
                            Electron: [Ar] 3d⁷ 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ni">
                        Ni
                        <div class="tooltip">
                            <strong>Nickel (Ni)</strong><br>
                            Atomic No: 28<br>
                            Mass: 58.693<br>
                            Electron: [Ar] 3d⁸ 4s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Cu">
                        Cu
                        <div class="tooltip">
                            <strong>Copper (Cu)</strong><br>
                            Atomic No: 29<br>
                            Mass: 63.546<br>
                            Electron: [Ar] 3d¹⁰ 4s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Zn">
                        Zn
                        <div class="tooltip">
                            <strong>Zinc (Zn)</strong><br>
                            Atomic No: 30<br>
                            Mass: 65.38<br>
                            Electron: [Ar] 3d¹⁰ 4s²
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Ga">
                        Ga
                        <div class="tooltip">
                            <strong>Gallium (Ga)</strong><br>
                            Atomic No: 31<br>
                            Mass: 69.723<br>
                            Electron: [Ar] 3d¹⁰ 4s² 4p¹
                        </div>
                    </div>
                    <div class="element metalloid" data-symbol="Ge">
                        Ge
                        <div class="tooltip">
                            <strong>Germanium (Ge)</strong><br>
                            Atomic No: 32<br>
                            Mass: 72.64<br>
                            Electron: [Ar] 3d¹⁰ 4s² 4p²
                        </div>
                    </div>
                    <div class="element metalloid" data-symbol="As">
                        As
                        <div class="tooltip">
                            <strong>Arsenic (As)</strong><br>
                            Atomic No: 33<br>
                            Mass: 74.922<br>
                            Electron: [Ar] 3d¹⁰ 4s² 4p³
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="Se">
                        Se
                        <div class="tooltip">
                            <strong>Selenium (Se)</strong><br>
                            Atomic No: 34<br>
                            Mass: 78.96<br>
                            Electron: [Ar] 3d¹⁰ 4s² 4p⁴
                        </div>
                    </div>
                    <div class="element halogen" data-symbol="Br">
                        Br
                        <div class="tooltip">
                            <strong>Bromine (Br)</strong><br>
                            Atomic No: 35<br>
                            Mass: 79.904<br>
                            Electron: [Ar] 3d¹⁰ 4s² 4p⁵
                        </div>
                    </div>
                    <div class="element noble" data-symbol="Kr">
                        Kr
                        <div class="tooltip">
                            <strong>Krypton (Kr)</strong><br>
                            Atomic No: 36<br>
                            Mass: 83.798<br>
                            Electron: [Ar] 3d¹⁰ 4s² 4p⁶
                </div>
            </div>
            
                    <!-- 第五行 -->
                    <div class="element alkali" data-symbol="Rb">
                        Rb
                        <div class="tooltip">
                            <strong>Rubidium (Rb)</strong><br>
                            Atomic No: 37<br>
                            Mass: 85.468<br>
                            Electron: [Kr] 5s¹
                        </div>
                    </div>
                    <div class="element alkaline" data-symbol="Sr">
                        Sr
                        <div class="tooltip">
                            <strong>Strontium (Sr)</strong><br>
                            Atomic No: 38<br>
                            Mass: 87.62<br>
                            Electron: [Kr] 5s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Y">
                        Y
                        <div class="tooltip">
                            <strong>Yttrium (Y)</strong><br>
                            Atomic No: 39<br>
                            Mass: 88.906<br>
                            Electron: [Kr] 4d¹ 5s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Zr">
                        Zr
                        <div class="tooltip">
                            <strong>Zirconium (Zr)</strong><br>
                            Atomic No: 40<br>
                            Mass: 91.224<br>
                            Electron: [Kr] 4d² 5s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Nb">
                        Nb
                        <div class="tooltip">
                            <strong>Niobium (Nb)</strong><br>
                            Atomic No: 41<br>
                            Mass: 92.906<br>
                            Electron: [Kr] 4d⁴ 5s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Mo">
                        Mo
                        <div class="tooltip">
                            <strong>Molybdenum (Mo)</strong><br>
                            Atomic No: 42<br>
                            Mass: 95.94<br>
                            Electron: [Kr] 4d⁵ 5s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Tc">
                        Tc
                        <div class="tooltip">
                            <strong>Technetium (Tc)</strong><br>
                            Atomic No: 43<br>
                            Mass: 98<br>
                            Electron: [Kr] 4d⁵ 5s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ru">
                        Ru
                        <div class="tooltip">
                            <strong>Ruthenium (Ru)</strong><br>
                            Atomic No: 44<br>
                            Mass: 101.07<br>
                            Electron: [Kr] 4d⁷ 5s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Rh">
                        Rh
                        <div class="tooltip">
                            <strong>Rhodium (Rh)</strong><br>
                            Atomic No: 45<br>
                            Mass: 102.91<br>
                            Electron: [Kr] 4d⁸ 5s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Pd">
                        Pd
                        <div class="tooltip">
                            <strong>Palladium (Pd)</strong><br>
                            Atomic No: 46<br>
                            Mass: 106.42<br>
                            Electron: [Kr] 4d¹⁰
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ag">
                        Ag
                        <div class="tooltip">
                            <strong>Silver (Ag)</strong><br>
                            Atomic No: 47<br>
                            Mass: 107.87<br>
                            Electron: [Kr] 4d¹⁰ 5s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Cd">
                        Cd
                        <div class="tooltip">
                            <strong>Cadmium (Cd)</strong><br>
                            Atomic No: 48<br>
                            Mass: 112.41<br>
                            Electron: [Kr] 4d¹⁰ 5s²
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="In">
                        In
                        <div class="tooltip">
                            <strong>Indium (In)</strong><br>
                            Atomic No: 49<br>
                            Mass: 114.82<br>
                            Electron: [Kr] 4d¹⁰ 5s² 5p¹
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Sn">
                        Sn
                        <div class="tooltip">
                            <strong>Tin (Sn)</strong><br>
                            Atomic No: 50<br>
                            Mass: 118.71<br>
                            Electron: [Kr] 4d¹⁰ 5s² 5p²
                        </div>
                    </div>
                    <div class="element metalloid" data-symbol="Sb">
                        Sb
                        <div class="tooltip">
                            <strong>Antimony (Sb)</strong><br>
                            Atomic No: 51<br>
                            Mass: 121.76<br>
                            Electron: [Kr] 4d¹⁰ 5s² 5p³
                        </div>
                    </div>
                    <div class="element nonmetal" data-symbol="Te">
                        Te
                        <div class="tooltip">
                            <strong>Tellurium (Te)</strong><br>
                            Atomic No: 52<br>
                            Mass: 127.6<br>
                            Electron: [Kr] 4d¹⁰ 5s² 5p⁴
                        </div>
                    </div>
                    <div class="element halogen" data-symbol="I">
                        I
                        <div class="tooltip">
                            <strong>Iodine (I)</strong><br>
                            Atomic No: 53<br>
                            Mass: 126.9<br>
                            Electron: [Kr] 4d¹⁰ 5s² 5p⁵
                        </div>
                    </div>
                    <div class="element noble" data-symbol="Xe">
                        Xe
                        <div class="tooltip">
                            <strong>Xenon (Xe)</strong><br>
                            Atomic No: 54<br>
                            Mass: 131.29<br>
                            Electron: [Kr] 4d¹⁰ 5s² 5p⁶
                        </div>
                    </div>
                    
                    <!-- 第六行 -->
                    <div class="element alkali" data-symbol="Cs">
                        Cs
                        <div class="tooltip">
                            <strong>Cesium (Cs)</strong><br>
                            Atomic No: 55<br>
                            Mass: 132.91<br>
                            Electron: [Xe] 6s¹
                        </div>
                    </div>
                    <div class="element alkaline" data-symbol="Ba">
                        Ba
                        <div class="tooltip">
                            <strong>Barium (Ba)</strong><br>
                            Atomic No: 56<br>
                            Mass: 137.33<br>
                            Electron: [Xe] 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="La">
                        La
                        <div class="tooltip">
                            <strong>Lanthanum (La)</strong><br>
                            Atomic No: 57<br>
                            Mass: 138.91<br>
                            Electron: [Xe] 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Hf">
                        Hf
                        <div class="tooltip">
                            <strong>Hafnium (Hf)</strong><br>
                            Atomic No: 72<br>
                            Mass: 178.49<br>
                            Electron: [Xe] 4f¹⁴ 5d² 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ta">
                        Ta
                        <div class="tooltip">
                            <strong>Tantalum (Ta)</strong><br>
                            Atomic No: 73<br>
                            Mass: 180.95<br>
                            Electron: [Xe] 4f¹⁴ 5d³ 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="W">
                        W
                        <div class="tooltip">
                            <strong>Tungsten (W)</strong><br>
                            Atomic No: 74<br>
                            Mass: 183.84<br>
                            Electron: [Xe] 4f¹⁴ 5d⁴ 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Re">
                        Re
                        <div class="tooltip">
                            <strong>Rhenium (Re)</strong><br>
                            Atomic No: 75<br>
                            Mass: 186.21<br>
                            Electron: [Xe] 4f¹⁴ 5d⁵ 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Os">
                        Os
                        <div class="tooltip">
                            <strong>Osmium (Os)</strong><br>
                            Atomic No: 76<br>
                            Mass: 190.23<br>
                            Electron: [Xe] 4f¹⁴ 5d⁶ 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ir">
                        Ir
                        <div class="tooltip">
                            <strong>Iridium (Ir)</strong><br>
                            Atomic No: 77<br>
                            Mass: 192.22<br>
                            Electron: [Xe] 4f¹⁴ 5d⁷ 6s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Pt">
                        Pt
                        <div class="tooltip">
                            <strong>Platinum (Pt)</strong><br>
                            Atomic No: 78<br>
                            Mass: 195.08<br>
                            Electron: [Xe] 4f¹⁴ 5d⁹ 6s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Au">
                        Au
                        <div class="tooltip">
                            <strong>Gold (Au)</strong><br>
                            Atomic No: 79<br>
                            Mass: 196.97<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s¹
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Hg">
                        Hg
                        <div class="tooltip">
                            <strong>Mercury (Hg)</strong><br>
                            Atomic No: 80<br>
                            Mass: 200.59<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s²
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Tl">
                        Tl
                        <div class="tooltip">
                            <strong>Thallium (Tl)</strong><br>
                            Atomic No: 81<br>
                            Mass: 204.38<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s² 6p¹
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Pb">
                        Pb
                        <div class="tooltip">
                            <strong>Lead (Pb)</strong><br>
                            Atomic No: 82<br>
                            Mass: 207.2<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s² 6p²
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Bi">
                        Bi
                        <div class="tooltip">
                            <strong>Bismuth (Bi)</strong><br>
                            Atomic No: 83<br>
                            Mass: 208.98<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s² 6p³
                        </div>
                    </div>
                    <div class="element metalloid" data-symbol="Po">
                        Po
                        <div class="tooltip">
                            <strong>Polonium (Po)</strong><br>
                            Atomic No: 84<br>
                            Mass: 209<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s² 6p⁴
                        </div>
                    </div>
                    <div class="element halogen" data-symbol="At">
                        At
                        <div class="tooltip">
                            <strong>Astatine (At)</strong><br>
                            Atomic No: 85<br>
                            Mass: 210<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s² 6p⁵
                        </div>
                    </div>
                    <div class="element noble" data-symbol="Rn">
                        Rn
                        <div class="tooltip">
                            <strong>Radon (Rn)</strong><br>
                            Atomic No: 86<br>
                            Mass: 222<br>
                            Electron: [Xe] 4f¹⁴ 5d¹⁰ 6s² 6p⁶
                        </div>
                    </div>
                    
                    <!-- 第七行 -->
                    <div class="element alkali" data-symbol="Fr">
                        Fr
                        <div class="tooltip">
                            <strong>Francium (Fr)</strong><br>
                            Atomic No: 87<br>
                            Mass: 223<br>
                            Electron: [Rn] 7s¹
                        </div>
                    </div>
                    <div class="element alkaline" data-symbol="Ra">
                        Ra
                        <div class="tooltip">
                            <strong>Radium (Ra)</strong><br>
                            Atomic No: 88<br>
                            Mass: 226<br>
                            Electron: [Rn] 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Ac">
                        Ac
                        <div class="tooltip">
                            <strong>Actinium (Ac)</strong><br>
                            Atomic No: 89<br>
                            Mass: 227<br>
                            Electron: [Rn] 6d¹ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Rf">
                        Rf
                        <div class="tooltip">
                            <strong>Rutherfordium (Rf)</strong><br>
                            Atomic No: 104<br>
                            Mass: 267<br>
                            Electron: [Rn] 5f¹⁴ 6d² 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Db">
                        Db
                        <div class="tooltip">
                            <strong>Dubnium (Db)</strong><br>
                            Atomic No: 105<br>
                            Mass: 268<br>
                            Electron: [Rn] 5f¹⁴ 6d³ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Sg">
                        Sg
                        <div class="tooltip">
                            <strong>Seaborgium (Sg)</strong><br>
                            Atomic No: 106<br>
                            Mass: 271<br>
                            Electron: [Rn] 5f¹⁴ 6d⁴ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Bh">
                        Bh
                        <div class="tooltip">
                            <strong>Bohrium (Bh)</strong><br>
                            Atomic No: 107<br>
                            Mass: 272<br>
                            Electron: [Rn] 5f¹⁴ 6d⁵ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Hs">
                        Hs
                        <div class="tooltip">
                            <strong>Hassium (Hs)</strong><br>
                            Atomic No: 108<br>
                            Mass: 270<br>
                            Electron: [Rn] 5f¹⁴ 6d⁶ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Mt">
                        Mt
                        <div class="tooltip">
                            <strong>Meitnerium (Mt)</strong><br>
                            Atomic No: 109<br>
                            Mass: 278<br>
                            Electron: [Rn] 5f¹⁴ 6d⁷ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Ds">
                        Ds
                        <div class="tooltip">
                            <strong>Darmstadtium (Ds)</strong><br>
                            Atomic No: 110<br>
                            Mass: 281<br>
                            Electron: [Rn] 5f¹⁴ 6d⁸ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Rg">
                        Rg
                        <div class="tooltip">
                            <strong>Roentgenium (Rg)</strong><br>
                            Atomic No: 111<br>
                            Mass: 281<br>
                            Electron: [Rn] 5f¹⁴ 6d⁹ 7s²
                        </div>
                    </div>
                    <div class="element transition" data-symbol="Cn">
                        Cn
                        <div class="tooltip">
                            <strong>Copernicium (Cn)</strong><br>
                            Atomic No: 112<br>
                            Mass: 285<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s²
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Nh">
                        Nh
                        <div class="tooltip">
                            <strong>Nihonium (Nh)</strong><br>
                            Atomic No: 113<br>
                            Mass: 286<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s² 7p¹
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Fl">
                        Fl
                        <div class="tooltip">
                            <strong>Flerovium (Fl)</strong><br>
                            Atomic No: 114<br>
                            Mass: 289<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s² 7p²
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Mc">
                        Mc
                        <div class="tooltip">
                            <strong>Moscovium (Mc)</strong><br>
                            Atomic No: 115<br>
                            Mass: 289<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s² 7p³
                        </div>
                    </div>
                    <div class="element post-transition" data-symbol="Lv">
                        Lv
                        <div class="tooltip">
                            <strong>Livermorium (Lv)</strong><br>
                            Atomic No: 116<br>
                            Mass: 293<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s² 7p⁴
                        </div>
                    </div>
                    <div class="element halogen" data-symbol="Ts">
                        Ts
                        <div class="tooltip">
                            <strong>Tennessine (Ts)</strong><br>
                            Atomic No: 117<br>
                            Mass: 294<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s² 7p⁵
                        </div>
                    </div>
                    <div class="element noble" data-symbol="Og">
                        Og
                        <div class="tooltip">
                            <strong>Oganesson (Og)</strong><br>
                            Atomic No: 118<br>
                            Mass: 294<br>
                            Electron: [Rn] 5f¹⁴ 6d¹⁰ 7s² 7p⁶
                        </div>
                    </div>
                    
                    <!-- 镧系 -->
                    <div style="grid-column: span 3;"></div>
                    <div class="element lanthanoid" data-symbol="Ce">
                        Ce
                        <div class="tooltip">
                            <strong>Cerium (Ce)</strong><br>
                            Atomic No: 58<br>
                            Mass: 140.12<br>
                            Electron: [Xe] 4f¹ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Pr">
                        Pr
                        <div class="tooltip">
                            <strong>Praseodymium (Pr)</strong><br>
                            Atomic No: 59<br>
                            Mass: 140.91<br>
                            Electron: [Xe] 4f³ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Nd">
                        Nd
                        <div class="tooltip">
                            <strong>Neodymium (Nd)</strong><br>
                            Atomic No: 60<br>
                            Mass: 144.24<br>
                            Electron: [Xe] 4f⁴ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Pm">
                        Pm
                        <div class="tooltip">
                            <strong>Promethium (Pm)</strong><br>
                            Atomic No: 61<br>
                            Mass: 145<br>
                            Electron: [Xe] 4f⁵ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Sm">
                        Sm
                        <div class="tooltip">
                            <strong>Samarium (Sm)</strong><br>
                            Atomic No: 62<br>
                            Mass: 150.36<br>
                            Electron: [Xe] 4f⁶ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Eu">
                        Eu
                        <div class="tooltip">
                            <strong>Europium (Eu)</strong><br>
                            Atomic No: 63<br>
                            Mass: 151.96<br>
                            Electron: [Xe] 4f⁷ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Gd">
                        Gd
                        <div class="tooltip">
                            <strong>Gadolinium (Gd)</strong><br>
                            Atomic No: 64<br>
                            Mass: 157.25<br>
                            Electron: [Xe] 4f⁷ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Tb">
                        Tb
                        <div class="tooltip">
                            <strong>Terbium (Tb)</strong><br>
                            Atomic No: 65<br>
                            Mass: 158.93<br>
                            Electron: [Xe] 4f⁹ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Dy">
                        Dy
                        <div class="tooltip">
                            <strong>Dysprosium (Dy)</strong><br>
                            Atomic No: 66<br>
                            Mass: 162.50<br>
                            Electron: [Xe] 4f¹⁰ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Ho">
                        Ho
                        <div class="tooltip">
                            <strong>Holmium (Ho)</strong><br>
                            Atomic No: 67<br>
                            Mass: 164.93<br>
                            Electron: [Xe] 4f¹¹ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Er">
                        Er
                        <div class="tooltip">
                            <strong>Erbium (Er)</strong><br>
                            Atomic No: 68<br>
                            Mass: 167.26<br>
                            Electron: [Xe] 4f¹² 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Tm">
                        Tm
                        <div class="tooltip">
                            <strong>Thulium (Tm)</strong><br>
                            Atomic No: 69<br>
                            Mass: 168.93<br>
                            Electron: [Xe] 4f¹³ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Yb">
                        Yb
                        <div class="tooltip">
                            <strong>Ytterbium (Yb)</strong><br>
                            Atomic No: 70<br>
                            Mass: 173.04<br>
                            Electron: [Xe] 4f¹⁴ 5d¹ 6s²
                        </div>
                    </div>
                    <div class="element lanthanoid" data-symbol="Lu">
                        Lu
                        <div class="tooltip">
                            <strong>Lutetium (Lu)</strong><br>
                            Atomic No: 71<br>
                            Mass: 174.97<br>
                            Electron: [Xe] 4f¹⁴ 5d¹ 6s²
                        </div>
                    </div>
                    
                    <!-- 锕系 -->
                    <div style="grid-column: span 3;"></div>
                    <div class="element actinoid" data-symbol="Th">
                        Th
                        <div class="tooltip">
                            <strong>Thorium (Th)</strong><br>
                            Atomic No: 90<br>
                            Mass: 232.04<br>
                            Electron: [Rn] 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Pa">
                        Pa
                        <div class="tooltip">
                            <strong>Protactinium (Pa)</strong><br>
                            Atomic No: 91<br>
                            Mass: 231.04<br>
                            Electron: [Rn] 5f² 6d¹ 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="U">
                        U
                        <div class="tooltip">
                            <strong>Uranium (U)</strong><br>
                            Atomic No: 92<br>
                            Mass: 238.03<br>
                            Electron: [Rn] 5f³ 6d¹ 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Np">
                        Np
                        <div class="tooltip">
                            <strong>Neptunium (Np)</strong><br>
                            Atomic No: 93<br>
                            Mass: 237<br>
                            Electron: [Rn] 5f⁴ 6d¹ 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Pu">
                        Pu
                        <div class="tooltip">
                            <strong>Plutonium (Pu)</strong><br>
                            Atomic No: 94<br>
                            Mass: 244<br>
                            Electron: [Rn] 5f⁶ 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Am">
                        Am
                        <div class="tooltip">
                            <strong>Americium (Am)</strong><br>
                            Atomic No: 95<br>
                            Mass: 243<br>
                            Electron: [Rn] 5f⁷ 6d³ 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Cm">
                        Cm
                        <div class="tooltip">
                            <strong>Curium (Cm)</strong><br>
                            Atomic No: 96<br>
                            Mass: 247<br>
                            Electron: [Rn] 5f⁷ 6d⁴ 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Bk">
                        Bk
                        <div class="tooltip">
                            <strong>Berkelium (Bk)</strong><br>
                            Atomic No: 97<br>
                            Mass: 247<br>
                            Electron: [Rn] 5f⁸ 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Cf">
                        Cf
                        <div class="tooltip">
                            <strong>Californium (Cf)</strong><br>
                            Atomic No: 98<br>
                            Mass: 251<br>
                            Electron: [Rn] 5f¹⁰ 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Es">
                        Es
                        <div class="tooltip">
                            <strong>Einsteinium (Es)</strong><br>
                            Atomic No: 99<br>
                            Mass: 252<br>
                            Electron: [Rn] 5f¹² 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Fm">
                        Fm
                        <div class="tooltip">
                            <strong>Fermium (Fm)</strong><br>
                            Atomic No: 100<br>
                            Mass: 257<br>
                            Electron: [Rn] 5f¹⁴ 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Md">
                        Md
                        <div class="tooltip">
                            <strong>Mendelevium (Md)</strong><br>
                            Atomic No: 101<br>
                            Mass: 258<br>
                            Electron: [Rn] 5f¹⁶ 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="No">
                        No
                        <div class="tooltip">
                            <strong>Nobelium (No)</strong><br>
                            Atomic No: 102<br>
                            Mass: 259<br>
                            Electron: [Rn] 5f¹⁸ 6d² 7s²
                        </div>
                    </div>
                    <div class="element actinoid" data-symbol="Lr">
                        Lr
                        <div class="tooltip">
                            <strong>Lawrencium (Lr)</strong><br>
                            Atomic No: 103<br>
                            Mass: 262<br>
                            Electron: [Rn] 5f¹⁴ 6d² 7s²
                        </div>
                    </div>
                </div>
                
                <!-- 隐藏的元素输入字段 -->
                <input type="hidden" name="elements" id="selectedElements" value="{{ search_params.elements }}">
                
                <div class="element-controls">
                    <button type="button" class="btn btn-sm" id="clearElements">Clear All</button>
                </div>
            </div>
        </div>
        <style>
        /* 元素周期表组件样式 */
        .periodic-table-wrapper {
            margin-top: 1rem;
            border: 1px solid #D9E2F0;
            border-radius: 6px;
            background-color: #fff;
            /* Removing overflow: hidden to allow tooltips to extend beyond the wrapper */
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }
        
        .elements-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 1.2rem;
            background-color: #f8fafc;
            border-bottom: 1px solid #D9E2F0;
            font-weight: 500;
        }
        
        .periodic-table-container {
            padding: 1.2rem;
            /* Removing max-height and overflow-y to show all content without scrollbar */
            /* max-height: 450px; */
            /* overflow-y: auto; */
            position: relative;
        }
        
        .periodic-table {
            display: grid;
            grid-template-columns: repeat(18, minmax(30px, 1fr));
            gap: 3px;
            width: 100%;
        }
        
        .element {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 4px;
            font-size: 0.8rem;
            font-weight: 500;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            aspect-ratio: 1/1;
            border: 1px solid rgba(0,0,0,0.06);
            position: relative;
        }
        
        .element:hover {
            transform: scale(1.08);
            z-index: 2;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
        }
        
        .element.selected {
            box-shadow: 0 0 0 2px var(--primary-color);
            color: white;
            background-color: var(--primary-color);
        }
        
        .element-controls {
            display: flex;
            justify-content: flex-end;
            gap: 0.8rem;
            margin-top: 1.2rem;
            padding-top: 1rem;
            border-top: 1px solid #edf2f7;
        }
        
        .element-controls .btn {
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            border-radius: 4px;
        }
        
        .element-controls .btn-sm {
            padding: 0.3rem 0.8rem;
            font-size: 0.8rem;
        }
        
        #clearElements {
            background-color: #f1f5f9;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }
        
        #clearElements:hover {
            background-color: #e2e8f0;
        }
        
        /* Element tooltip styles */
        .element .tooltip {
            visibility: hidden;
            position: absolute;
            top: 110%; /* Position below element */
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.9);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px 14px;
            white-space: nowrap;
            font-size: 0.75rem;
            line-height: 1.4;
            opacity: 0;
            transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
            z-index: 1000; /* Highest z-index to ensure visibility */
            pointer-events: none;
            width: max-content;
            max-width: 220px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        }
        
        .element .tooltip::after {
            content: "";
            position: absolute;
            bottom: 100%; /* Arrow at top of tooltip */
            left: 50%;
            margin-left: -6px;
            border-width: 6px;
            border-style: solid;
            border-color: transparent transparent rgba(0, 0, 0, 0.9) transparent;
        }
        
        .element:hover .tooltip {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) translateY(2px); /* Slight movement for better UX */
        }
        
        .element .tooltip strong {
            color: #6ee7ff; /* Highlight element name */
            font-size: 0.85rem;
        }
        </style>

        <!-- 周期表样式 -->
        <style>
        /* 元素类型颜色 */
        .alkali {
          background-color: #ffcdd2;
        }

        .alkaline {
          background-color: #f8bbd0;
        }

        .transition {
          background-color: #bbdefb;
        }

        .post-transition {
          background-color: #b2dfdb;
        }

        .metalloid {
          background-color: #c8e6c9;
        }

        .nonmetal {
          background-color: #dcedc8;
        }

        .halogen {
          background-color: #f0f4c3;
        }

        .noble {
          background-color: #d1c4e9;
        }

        .lanthanoid {
          background-color: #ffe0b2;
        }

        .actinoid {
          background-color: #ffccbc;
        }
        </style>

        <!-- 高级搜索 -->
        <div class="advanced-search" id="advancedSearch">
            <div class="filters">
                <!-- 状态下拉框 -->
                <div class="filter-group">
                    <label for="status">Status</label>
                    <select name="status" id="status">
                        <option value="">All</option>
                        <option value="active" {% if search_params.status == 'active' %}selected{% endif %}>Active</option>
                        <option value="pending" {% if search_params.status == 'pending' %}selected{% endif %}>Pending</option>
                        <option value="archived" {% if search_params.status == 'archived' %}selected{% endif %}>Archived</option>
                    </select>
                </div>

                <!-- 金属类型下拉框 -->
                <div class="filter-group">
                    <label for="metal_type">Metal Type</label>
                    <select name="metal_type" id="metal_type">
                        <option value="">All</option>
                        <option value="metal" {% if search_params.metal_type == 'metal' %}selected{% endif %}>Metal</option>
                        <option value="nonmetal" {% if search_params.metal_type == 'nonmetal' %}selected{% endif %}>Non-metal</option>
                        <option value="metalloid" {% if search_params.metal_type == 'metalloid' %}selected{% endif %}>Metalloid</option>
                    </select>
                </div>
            </div>
        </div>
        <style>
        /* 高级搜索样式 */
        .advanced-search {
            display: none;  /* 默认隐藏 */
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #edf2f7;
        }

        .advanced-search.show {
            display: block;
        }

        .search-row {
            display: flex;
            flex-direction: row;
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        /* 保证当一行有两个搜索组时能够均分宽度 */
        .search-row .search-group {
            flex: 1;
        }

        .search-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .search-actions button,
        .search-actions .clear-btn button {
            padding: 0.5rem 1.25rem;
            font-size: 0.95rem;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .search-actions .search-btn {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .search-actions .search-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-1px);
        }

        .search-actions .clear-btn {
            text-decoration: none;
        }

        .search-actions .clear-btn button {
            background-color: #f5f5f5;
            color: #555;
            border: 1px solid #e0e0e0;
        }

        .search-actions .clear-btn button:hover {
            background-color: #e8e8e8;
            transform: translateY(-1px);
        }

        /* 范围输入框的样式 */
        .range-inputs {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .range-inputs input {
            flex: 1;
        }
        
        .range-inputs span {
            color: #666;
            font-weight: 500;
        }
        </style>
        
        <!-- 搜索验证提示 -->
        <div id="searchAlert" class="search-alert" style="display: none;">
            <i class="fas fa-exclamation-circle"></i>
            <span>Please enter search criteria or select at least one filter before searching.</span>
        </div>
        <style>
        /* 搜索验证提示样式 */
        .search-alert {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            background-color: #fff4e5;
            border-left: 4px solid #ff9800;
            color: #663c00;
            border-radius: 4px;
            font-size: 0.95rem;
            animation: fadeIn 0.3s ease-in-out;
        }

        .search-alert i {
            color: #ff9800;
            font-size: 1.2rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        </style>
    </form>

    <!-- 搜索结果信息 -->
    <div class="search-info">
        {% if search_params|any %}
            <div class="search-summary">
                Searching with filters:
            </div>
            <div class="active-filters">
                {% for key, value in search_params.items() %}
                    {% if value %}
                        <span class="filter-tag">
                            <span class="filter-key">{{ key|title }}</span>
                            <span class="filter-value">{{ value }}</span>
                            <a href="{{ url_for('views.index', **(search_params|remove_key(key))) }}" class="remove-filter" title="Remove this filter">
                                <i class="fas fa-times"></i>
                            </a>
                        </span>
                    {% endif %}
                {% endfor %}
                <a href="{{ url_for('views.index') }}" class="clear-all-filters">Clear All</a>
            </div>
        {% endif %}
    </div>
    <style>
    /* 搜索筛选标签样式 */
    .search-info {
        margin: 1.5rem 0 0.5rem;
    }
    
    .search-summary {
        font-size: 0.95rem;
        color: #64748b;
        margin-bottom: 0.75rem;
        font-weight: 500;
    }
    
    .active-filters {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        align-items: center;
    }

    .filter-tag {
        display: flex;
        align-items: center;
        background-color: var(--light-bg);
        border: 1px solid #D9E2F0;
        border-radius: 6px;
        padding: 0;
        font-size: 0.9rem;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
        transition: all 0.2s;
    }
    
    .filter-tag:hover {
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.08);
        transform: translateY(-1px);
    }
    
    .filter-key {
        background-color: rgba(0, 71, 171, 0.08);
        color: var(--primary-color);
        padding: 6px 10px;
        font-weight: 600;
        border-right: 1px solid #D9E2F0;
    }
    
    .filter-value {
        padding: 6px 10px;
        color: #333;
    }

    .remove-filter {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 6px 10px;
        color: #64748b;
        text-decoration: none;
        background-color: transparent;
        transition: all 0.2s;
        border-left: 1px solid #D9E2F0;
    }
    
    .remove-filter:hover {
        background-color: #ffebee;
        color: #e53935;
    }
    
    .clear-all-filters {
        color: var(--primary-color);
        font-size: 0.9rem;
        text-decoration: none;
        padding: 6px 12px;
        background-color: rgba(0, 71, 171, 0.08);
        border-radius: 6px;
        font-weight: 500;
        transition: all 0.2s;
    }
    
    .clear-all-filters:hover {
        background-color: rgba(0, 71, 171, 0.15);
        text-decoration: underline;
    }
    </style>

    <!-- 表格标题 -->
    <div class="table-title">
        <span class="title2">Total {{ materials|length }} Materials This Page</span>
    </div>
    <style>
    /* 表格相关样式 */
    .table-title {
      margin: 1.5rem 0 0.5rem;
      font-weight: 600;             /* 加粗 */
    }

    .title2 {
      color: #333333;               /* 黑色文字 */
      font-weight: 600;             /* 加粗 */
      font-size: 1.1rem;            /* 适当的字体大小 */
    }
    </style>

    <!-- 表格 -->
    <table class="material-data-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Material Name</th>
                <th>Fermi Level (eV)</th>
                <th>Total Energy (eV)</th>
                <th>Formation Energy (eV)</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for material in materials %}
            <tr>
                <td>{{ material.formatted_id or 'IMR-' + '%08d'|format(material.id) }}</td>
                <td>
                    <a href="{{ url_for('views.detail', material_id=material.id) }}" class="material-link">
                        {{ material.name }}
                    </a>
                </td>
                <td>{{ material.fermi_level if material.fermi_level is not none else 'N/A' }}</td>
                <td>{{ material.total_energy if material.total_energy is not none else 'N/A' }}</td>
                <td>{{ material.formation_energy if material.formation_energy is not none else 'N/A' }}</td>
                <td>
                    <div class="action-buttons">
                        <a class="mp" 
                           href="https://materialsproject.org/materials/{{ material.name }}" 
                           target="_blank"
                           title="View in MP">
                           MP
                        </a>
                        {% if current_user.is_authenticated %}
                        <a class="btn" 
                           href="{{ url_for('views.edit', material_id=material.id) }}">
                           Edit
                        </a>
                        <form method="post" 
                              action="{{ url_for('views.delete', material_id=material.id) }}">
                            <button class="btn" 
                                    type="submit" 
                                    onclick="return confirm('Delete permanently?')">Del</button>
                        </form>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <style>
    /* 表格样式 */
    .material-data-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin: 2rem 0;
    }

    .material-data-table th {
        background-color: #f1f5f9;
        color: #333333;
        padding: 1rem;
        text-align: left;
        font-weight: 700;
        background: #f8f9fa;
        border-bottom: 2px solid #dee2e6;
    }

    .material-data-table td {
        padding: 1rem;
        border-bottom: 1px solid #edf2f7;
    }

    .material-data-table tr:hover {
        background-color: var(--light-bg);
    }

    /* 表格左对齐 */
    .material-data-table th,
    .material-data-table td {
        text-align: left;
        vertical-align: middle;
        padding: 16px 12px;  /* 增加上下内边距以增大行距 */
    }
    
    /* 只让操作按钮居中对齐 */
    .material-data-table td:last-child {
        text-align: center;
    }

    .material-data-table tbody tr:nth-child(even) {
        background-color: #f8f9fa;  /* 偶数行使用浅灰色背景 */
    }

    .material-data-table tbody tr:nth-child(odd) {
        background-color: #ffffff;  /* 奇数行使用白色背景 */
    }

    .material-link {
        color: var(--primary-color);
        text-decoration: none;
        font-weight: 500;
    }

    .material-link:hover {
        color: var(--secondary-color);
    }

    /* 操作按钮样式 */
    .action-buttons {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        flex-wrap: nowrap;
    }

    /* 表单内联布局 */
    .action-buttons form {
        display: inline-block;
        margin: 0;
    }
    
    /* 统一操作按钮样式 */
    .action-buttons .btn,
    .action-buttons form .btn {
        padding: 0.4rem 0.75rem;
        font-size: 0.85rem;
        border-radius: 4px;
        background-color: var(--primary-color);
        color: white;
        border: none;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        font-weight: 500;
        display: inline-block;
        line-height: 1;
    }
    
    .action-buttons .btn:hover,
    .action-buttons form .btn:hover {
        background-color: var(--secondary-color);
        transform: translateY(-1px);
    }
    
    .action-buttons .mp {
        padding: 0.4rem 0.75rem;
        font-size: 0.85rem;
        border-radius: 4px;
        background-color: #f5f5f5;
        color: #333;
        border: 1px solid #e0e0e0;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        font-weight: 600;
        display: inline-block;
        line-height: 1;
    }
    
    .action-buttons .mp:hover {
        background-color: #e0e0e0;
        transform: translateY(-1px);
    }
    </style>

    <!-- 分页导航 -->
    {% if pagination.pages > 1 %}
    <div class="pagination">
        {% if pagination.has_prev %}
		    <a href="{{ url_for('views.index', page=pagination.prev_num, **search_params) }}">« Previous</a>
        {% endif %}

        {% for page_num in pagination.iter_pages() %}
            {% if page_num %}
			    <a href="{{ url_for('views.index', page=page_num, **search_params) }}" 
                   class="{% if page_num == pagination.page %}active{% endif %}">
                    {{ page_num }}
                </a>
            {% else %}
                <span class="ellipsis">...</span>
            {% endif %}
        {% endfor %}

        {% if pagination.has_next %}
		    <a href="{{ url_for('views.index', page=pagination.next_num, **search_params) }}">Next »</a>
        {% endif %}
    </div>
    {% endif %}
    <style>
    /* 修改分页按钮样式 */
    .pagination {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 2rem;
    }

    .pagination a {
        padding: 0.3rem 1rem;  /* 减小上下内边距，增加左右内边距 */
        border-radius: 4px;
        text-decoration: none;
        color: var(--text-color);
        background-color: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        transition: all 0.2s;
        font-weight: 500;
        border: 1px solid #e2e8f0;
        font-size: 0.9rem;
    }

    .pagination a:hover {
        background-color: #f8fafc;
        color: var(--primary-color);
        border-color: var(--primary-color);
        transform: translateY(-1px);
    }

    .pagination .active {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    </style>
</div>

<!-- Root CSS Variables -->
<style>
    :root {
        --primary-color: #0047AB;        /* 钴蓝色 - 主色调 */
        --secondary-color: #1E5CB3;      /* 稍微浅一些的蓝色 */
        --accent-color: #007FFF;         /* 天蓝色 - 强调色 */
        --text-color: #333333;           /* 深灰色文本 */
        --light-bg: #F5F8FF;             /* 非常浅的蓝色背景 */
        --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.08);
    }
</style>

<!-- JavaScript代码 -->
<script>
function toggleAdvanced() {
    const advancedSearch = document.getElementById('advancedSearch');
    if (advancedSearch.style.display === 'none' || !advancedSearch.style.display) {
        advancedSearch.style.display = 'block';
    } else {
        advancedSearch.style.display = 'none';
    }
}

function toggleElements() {
    const periodicTable = document.getElementById('periodicTableWrapper');
    if (periodicTable.style.display === 'none' || !periodicTable.style.display) {
        periodicTable.style.display = 'block';
    } else {
        periodicTable.style.display = 'none';
    }
}

// 元素周期表功能
document.addEventListener('DOMContentLoaded', function() {
    // 周期表切换按钮
    const elementsToggleBtn = document.getElementById('elementsToggleBtn');
    const periodicTableWrapper = document.getElementById('periodicTableWrapper');
    const selectedElementsInput = document.getElementById('selectedElements');
    const selectedElementsCount = document.getElementById('selectedElementsCount');
    const clearElementsBtn = document.getElementById('clearElements');
    const elements = document.querySelectorAll('.element');
    const searchForm = document.getElementById('searchForm');
    const searchInput = document.getElementById('searchInput');
    
    // 处理元素的悬浮工具提示位置
    elements.forEach(element => {
        element.addEventListener('mouseenter', function(e) {
            const tooltip = this.querySelector('.tooltip');
            if (!tooltip) return;
            
            // 基于视窗调整tooltip位置
            const rect = this.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // 重置位置样式
            tooltip.style.top = '110%';
            tooltip.style.left = '50%';
            tooltip.style.transform = 'translateX(-50%) translateY(2px)';
            tooltip.style.bottom = 'auto';
            tooltip.style.right = 'auto';
            
            // 创建元素后延迟检查位置
            setTimeout(() => {
                const updatedRect = tooltip.getBoundingClientRect();
                
                // 处理水平溢出
                if (updatedRect.right > viewportWidth) {
                    tooltip.style.left = 'auto';
                    tooltip.style.right = '0';
                    tooltip.style.transform = 'translateY(2px)';
                } else if (updatedRect.left < 0) {
                    tooltip.style.left = '0';
                    tooltip.style.transform = 'translateY(2px)';
                }
                
                // 处理垂直溢出
                if (updatedRect.bottom > viewportHeight) {
                    tooltip.style.top = 'auto';
                    tooltip.style.bottom = '110%';
                    
                    // 调整箭头位置为底部
                    const arrow = tooltip.querySelector('::after');
                    if (arrow) {
                        arrow.style.top = '100%';
                        arrow.style.bottom = 'auto';
                        arrow.style.borderColor = 'rgba(0, 0, 0, 0.9) transparent transparent transparent';
                    }
                }
            }, 0);
        });
    });
    
    // 添加切换按钮点击事件
    elementsToggleBtn.addEventListener('click', toggleElements);
    
    // 初始化已选中的元素
    let selectedElements = [];
    if (selectedElementsInput.value) {
        selectedElements = selectedElementsInput.value.split(',');
        updateSelectedCount();
        
        // 标记已选中的元素
        elements.forEach(el => {
            if (selectedElements.includes(el.dataset.symbol)) {
                el.classList.add('selected');
            }
        });
    }
    
    // 元素点击事件
    elements.forEach(element => {
        element.addEventListener('click', function() {
            const symbol = this.dataset.symbol;
            
            // 切换元素选择状态
            if (this.classList.contains('selected')) {
                // 如果已选中，则取消选择
                this.classList.remove('selected');
                selectedElements = selectedElements.filter(el => el !== symbol);
            } else {
                // 如果未选中，则选中
                this.classList.add('selected');
                selectedElements.push(symbol);
            }
            
            // 更新选中元素计数和隐藏字段
            updateSelectedCount();
            
            // 更新搜索输入框的值为所有选中元素
            searchInput.value = selectedElements.join(' ');
            
            // 不再自动隐藏周期表和提交表单
        });
    });
    
    // 清除所有选中的元素
    clearElementsBtn.addEventListener('click', function() {
        selectedElements = [];
        elements.forEach(el => el.classList.remove('selected'));
        updateSelectedCount();
    });
    
    // 更新选中元素计数
    function updateSelectedCount() {
        selectedElementsCount.textContent = `${selectedElements.length} selected`;
        selectedElementsInput.value = selectedElements.join(',');
    }
});

function validateSearch() {
    // 获取基本搜索输入
    const basicSearchInput = document.getElementById('searchInput').value.trim();
    
    // 获取所有高级搜索输入
    const advancedInputs = document.querySelectorAll('#advancedSearch input, #advancedSearch select');
    let hasAdvancedCriteria = false;
    
    // 检查是否有任何高级搜索条件
    for (let input of advancedInputs) {
        if (input.value && input.value.trim() !== '' && input.id !== 'selectedElements') {
            hasAdvancedCriteria = true;
            break;
        }
    }
    
    // 检查元素选择器
    const selectedElementsInput = document.getElementById('selectedElements');
    if (selectedElementsInput.value.trim() !== '') {
        hasAdvancedCriteria = true;
    }
    
    // 如果没有任何搜索条件，显示提示并阻止表单提交
    if (!basicSearchInput && !hasAdvancedCriteria) {
        const searchAlert = document.getElementById('searchAlert');
        searchAlert.style.display = 'flex';
        
        // 5秒后自动隐藏提示
        setTimeout(() => {
            searchAlert.style.display = 'none';
        }, 5000);
        
        return false; // 阻止表单提交
    }
    
    return true; // 允许表单提交
}
</script>

{% endblock %}
